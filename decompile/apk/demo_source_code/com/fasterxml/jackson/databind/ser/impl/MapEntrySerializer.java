// Decompiled by Jad v1.5.8g. Copyright 2001 Pavel Kouznetsov.
// Jad home page: http://www.kpdus.com/jad.html
// Decompiler options: packimports(3) fieldsfirst nonlb space 

package com.fasterxml.jackson.databind.ser.impl;

import com.fasterxml.jackson.core.JsonGenerator;
import com.fasterxml.jackson.databind.*;
import com.fasterxml.jackson.databind.jsontype.TypeSerializer;
import com.fasterxml.jackson.databind.ser.ContainerSerializer;
import com.fasterxml.jackson.databind.ser.ContextualSerializer;
import java.util.Map;

// Referenced classes of package com.fasterxml.jackson.databind.ser.impl:
//            PropertySerializerMap

public class MapEntrySerializer extends ContainerSerializer
    implements ContextualSerializer {

    protected PropertySerializerMap _dynamicValueSerializers;
    protected final JavaType _entryType;
    protected JsonSerializer _keySerializer;
    protected final JavaType _keyType;
    protected final BeanProperty _property;
    protected JsonSerializer _valueSerializer;
    protected final JavaType _valueType;
    protected final boolean _valueTypeIsStatic;
    protected final TypeSerializer _valueTypeSerializer;

    public MapEntrySerializer(JavaType javatype, JavaType javatype1, JavaType javatype2, boolean flag, TypeSerializer typeserializer, BeanProperty beanproperty) {
        super(javatype);
        _entryType = javatype;
        _keyType = javatype1;
        _valueType = javatype2;
        _valueTypeIsStatic = flag;
        _valueTypeSerializer = typeserializer;
        _property = beanproperty;
        _dynamicValueSerializers = PropertySerializerMap.emptyForProperties();
    }

    protected MapEntrySerializer(MapEntrySerializer mapentryserializer, BeanProperty beanproperty, TypeSerializer typeserializer, JsonSerializer jsonserializer, JsonSerializer jsonserializer1) {
        super(java/util/Map, false);
        _entryType = mapentryserializer._entryType;
        _keyType = mapentryserializer._keyType;
        _valueType = mapentryserializer._valueType;
        _valueTypeIsStatic = mapentryserializer._valueTypeIsStatic;
        _valueTypeSerializer = mapentryserializer._valueTypeSerializer;
        _keySerializer = jsonserializer;
        _valueSerializer = jsonserializer1;
        _dynamicValueSerializers = mapentryserializer._dynamicValueSerializers;
        _property = mapentryserializer._property;
    }

    protected final JsonSerializer _findAndAddDynamic(PropertySerializerMap propertyserializermap, JavaType javatype, SerializerProvider serializerprovider) {
        javatype = propertyserializermap.findAndAddSecondarySerializer(javatype, serializerprovider, _property);
        if (propertyserializermap != ((PropertySerializerMap.SerializerAndMapResult) (javatype)).map)
            _dynamicValueSerializers = ((PropertySerializerMap.SerializerAndMapResult) (javatype)).map;
        return ((PropertySerializerMap.SerializerAndMapResult) (javatype)).serializer;
    }

    protected final JsonSerializer _findAndAddDynamic(PropertySerializerMap propertyserializermap, Class class1, SerializerProvider serializerprovider) {
        class1 = propertyserializermap.findAndAddSecondarySerializer(class1, serializerprovider, _property);
        if (propertyserializermap != ((PropertySerializerMap.SerializerAndMapResult) (class1)).map)
            _dynamicValueSerializers = ((PropertySerializerMap.SerializerAndMapResult) (class1)).map;
        return ((PropertySerializerMap.SerializerAndMapResult) (class1)).serializer;
    }

    public ContainerSerializer _withValueTypeSerializer(TypeSerializer typeserializer) {
        return new MapEntrySerializer(this, _property, typeserializer, _keySerializer, _valueSerializer);
    }

    public JsonSerializer createContextual(SerializerProvider serializerprovider, BeanProperty beanproperty) {
        Object obj = null;
        Object obj2 = serializerprovider.getAnnotationIntrospector();
        Object obj1;
        if (beanproperty == null)
            obj1 = null;
        else
            obj1 = beanproperty.getMember();
        if (obj1 != null && obj2 != null) {
            obj = ((AnnotationIntrospector) (obj2)).findKeySerializer(((com.fasterxml.jackson.databind.introspect.Annotated) (obj1)));
            if (obj != null)
                obj = serializerprovider.serializerInstance(((com.fasterxml.jackson.databind.introspect.Annotated) (obj1)), obj);
            else
                obj = null;
            obj2 = ((AnnotationIntrospector) (obj2)).findContentSerializer(((com.fasterxml.jackson.databind.introspect.Annotated) (obj1)));
            if (obj2 != null)
                obj1 = serializerprovider.serializerInstance(((com.fasterxml.jackson.databind.introspect.Annotated) (obj1)), obj2);
            else
                obj1 = null;
        } else {
            obj1 = null;
        }
        obj2 = obj1;
        if (obj1 == null)
            obj2 = _valueSerializer;
        obj1 = findConvertingContentSerializer(serializerprovider, beanproperty, ((JsonSerializer) (obj2)));
        if (obj1 == null) {
            if (_valueTypeIsStatic && !_valueType.isJavaLangObject())
                obj1 = serializerprovider.findValueSerializer(_valueType, beanproperty);
        } else {
            obj1 = serializerprovider.handleSecondaryContextualization(((JsonSerializer) (obj1)), beanproperty);
        }
        if (obj == null)
            obj = _keySerializer;
        if (obj == null)
            serializerprovider = serializerprovider.findKeySerializer(_keyType, beanproperty);
        else
            serializerprovider = serializerprovider.handleSecondaryContextualization(((JsonSerializer) (obj)), beanproperty);
        return withResolved(beanproperty, serializerprovider, ((JsonSerializer) (obj1)));
    }

    public JsonSerializer getContentSerializer() {
        return _valueSerializer;
    }

    public JavaType getContentType() {
        return _valueType;
    }

    public volatile boolean hasSingleElement(Object obj) {
        return hasSingleElement((java.util.Map.Entry)obj);
    }

    public boolean hasSingleElement(java.util.Map.Entry entry) {
        return true;
    }

    public volatile boolean isEmpty(SerializerProvider serializerprovider, Object obj) {
        return isEmpty(serializerprovider, (java.util.Map.Entry)obj);
    }

    public boolean isEmpty(SerializerProvider serializerprovider, java.util.Map.Entry entry) {
        boolean flag;
        if (entry == null)
            flag = true;
        else
            flag = false;
        return flag;
    }

    public volatile void serialize(Object obj, JsonGenerator jsongenerator, SerializerProvider serializerprovider) {
        serialize((java.util.Map.Entry)obj, jsongenerator, serializerprovider);
    }

    public void serialize(java.util.Map.Entry entry, JsonGenerator jsongenerator, SerializerProvider serializerprovider) {
        jsongenerator.writeStartObject();
        jsongenerator.setCurrentValue(entry);
        if (_valueSerializer != null)
            serializeUsing(entry, jsongenerator, serializerprovider, _valueSerializer);
        else
            serializeDynamic(entry, jsongenerator, serializerprovider);
        jsongenerator.writeEndObject();
    }

    protected void serializeDynamic(java.util.Map.Entry entry, JsonGenerator jsongenerator, SerializerProvider serializerprovider) {
        boolean flag;
        JsonSerializer jsonserializer;
        Object obj;
        TypeSerializer typeserializer;
        Object obj1;
        PropertySerializerMap propertyserializermap1;
        jsonserializer = _keySerializer;
        if (!serializerprovider.isEnabled(SerializationFeature.WRITE_NULL_MAP_VALUES))
            flag = true;
        else
            flag = false;
        typeserializer = _valueTypeSerializer;
        propertyserializermap1 = _dynamicValueSerializers;
        obj1 = entry.getValue();
        obj = entry.getKey();
        if (obj != null) goto _L2; else goto _L1
_L1:
        serializerprovider.findNullKeySerializer(_keyType, _property).serialize(null, jsongenerator, serializerprovider);
_L5:
        if (obj1 == null) {
            serializerprovider.defaultSerializeNull(jsongenerator);
        } else {
label0:
            {
                Class class1 = obj1.getClass();
                JsonSerializer jsonserializer1 = propertyserializermap1.serializerFor(class1);
                jsonserializer = jsonserializer1;
                if (jsonserializer1 == null) {
                    PropertySerializerMap propertyserializermap;
                    if (_valueType.hasGenericTypes())
                        jsonserializer = _findAndAddDynamic(propertyserializermap1, serializerprovider.constructSpecializedType(_valueType, class1), serializerprovider);
                    else
                        jsonserializer = _findAndAddDynamic(propertyserializermap1, class1, serializerprovider);
                    propertyserializermap = _dynamicValueSerializers;
                }
                if (typeserializer != null)
                    break label0;
                try {
                    jsonserializer.serialize(obj1, jsongenerator, serializerprovider);
                }
                // Misplaced declaration of an exception variable
                catch (JsonGenerator jsongenerator) {
                    wrapAndThrow(serializerprovider, jsongenerator, entry, (new StringBuilder()).append("").append(obj).toString());
                }
            }
        }
_L4:
        return;
_L2:
        if (flag && obj1 == null) goto _L4; else goto _L3
_L3:
        jsonserializer.serialize(obj, jsongenerator, serializerprovider);
          goto _L5
        jsonserializer.serializeWithType(obj1, jsongenerator, serializerprovider, typeserializer);
          goto _L4
    }

    protected void serializeUsing(java.util.Map.Entry entry, JsonGenerator jsongenerator, SerializerProvider serializerprovider, JsonSerializer jsonserializer) {
        boolean flag;
        Object obj;
        Object obj1;
        JsonSerializer jsonserializer1;
        TypeSerializer typeserializer;
        jsonserializer1 = _keySerializer;
        typeserializer = _valueTypeSerializer;
        if (!serializerprovider.isEnabled(SerializationFeature.WRITE_NULL_MAP_VALUES))
            flag = true;
        else
            flag = false;
        obj1 = entry.getValue();
        obj = entry.getKey();
        if (obj != null) goto _L2; else goto _L1
_L1:
        serializerprovider.findNullKeySerializer(_keyType, _property).serialize(null, jsongenerator, serializerprovider);
_L5:
        if (obj1 == null) {
            serializerprovider.defaultSerializeNull(jsongenerator);
        } else {
label0:
            {
                if (typeserializer != null)
                    break label0;
                try {
                    jsonserializer.serialize(obj1, jsongenerator, serializerprovider);
                }
                // Misplaced declaration of an exception variable
                catch (JsonGenerator jsongenerator) {
                    wrapAndThrow(serializerprovider, jsongenerator, entry, (new StringBuilder()).append("").append(obj).toString());
                }
            }
        }
_L4:
        return;
_L2:
        if (flag && obj1 == null) goto _L4; else goto _L3
_L3:
        jsonserializer1.serialize(obj, jsongenerator, serializerprovider);
          goto _L5
        jsonserializer.serializeWithType(obj1, jsongenerator, serializerprovider, typeserializer);
          goto _L4
    }

    public volatile void serializeWithType(Object obj, JsonGenerator jsongenerator, SerializerProvider serializerprovider, TypeSerializer typeserializer) {
        serializeWithType((java.util.Map.Entry)obj, jsongenerator, serializerprovider, typeserializer);
    }

    public void serializeWithType(java.util.Map.Entry entry, JsonGenerator jsongenerator, SerializerProvider serializerprovider, TypeSerializer typeserializer) {
        typeserializer.writeTypePrefixForObject(entry, jsongenerator);
        jsongenerator.setCurrentValue(entry);
        if (_valueSerializer != null)
            serializeUsing(entry, jsongenerator, serializerprovider, _valueSerializer);
        else
            serializeDynamic(entry, jsongenerator, serializerprovider);
        typeserializer.writeTypeSuffixForObject(entry, jsongenerator);
    }

    public MapEntrySerializer withResolved(BeanProperty beanproperty, JsonSerializer jsonserializer, JsonSerializer jsonserializer1) {
        return new MapEntrySerializer(this, beanproperty, _valueTypeSerializer, jsonserializer, jsonserializer1);
    }
}
