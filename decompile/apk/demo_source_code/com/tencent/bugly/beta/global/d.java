// Decompiled by Jad v1.5.8g. Copyright 2001 Pavel Kouznetsov.
// Jad home page: http://www.kpdus.com/jad.html
// Decompiler options: packimports(3) fieldsfirst nonlb space 

package com.tencent.bugly.beta.global;

import android.content.Context;
import android.content.SharedPreferences;
import android.content.pm.*;
import android.os.Environment;
import android.util.DisplayMetrics;
import android.view.Display;
import android.view.WindowManager;
import com.tencent.bugly.beta.download.DownloadListener;
import com.tencent.bugly.beta.download.b;
import com.tencent.bugly.beta.ui.UILifecycleListener;
import com.tencent.bugly.beta.upgrade.BetaUploadStrategy;
import com.tencent.bugly.proguard.a;
import com.tencent.bugly.proguard.ag;
import java.io.File;
import java.util.ArrayList;
import java.util.List;

public final class d {

    public static final d D = new d();
    public static int a = 0;
    public DisplayMetrics A;
    public boolean B;
    public boolean C;
    public BetaUploadStrategy E;
    public boolean F;
    public long b;
    public long c;
    public boolean d;
    public boolean e;
    public int f;
    public int g;
    public int h;
    public int i;
    public int j;
    public UILifecycleListener k;
    public File l;
    public final List m = new ArrayList();
    public final List n = new ArrayList();
    public b o;
    public DownloadListener p;
    public File q;
    public Context r;
    public File s;
    public String t;
    public String u;
    public int v;
    public String w;
    public String x;
    public PackageInfo y;
    public SharedPreferences z;

    public d() {
        b = 3000L;
        c = 0L;
        d = true;
        e = true;
        v = 0x80000000;
        w = "";
        x = "";
        B = true;
        F = false;
    }

    public final void a(Context context) {
        this;
        JVM INSTR monitorenter ;
        PackageManager packagemanager;
        D.r = context.getApplicationContext();
        packagemanager = r.getPackageManager();
        y = packagemanager.getPackageInfo(r.getPackageName(), 16384);
        v = y.versionCode;
        w = y.versionName;
        x = (String)y.applicationInfo.loadLabel(packagemanager);
_L4:
        context = (WindowManager)context.getSystemService("window");
        DisplayMetrics displaymetrics = JVM INSTR new #151 <Class DisplayMetrics>;
        displaymetrics.DisplayMetrics();
        A = displaymetrics;
        context.getDefaultDisplay().getMetrics(A);
        context = JVM INSTR new #166 <Class StringBuilder>;
        context.StringBuilder();
        context = context.append(r.getPackageName()).append("/.beta/");
        if (l != null && l.exists()) goto _L2; else goto _L1
_L1:
        File file = JVM INSTR new #177 <Class File>;
        file.File(Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_DOWNLOADS), context.toString());
        l = file;
        context = JVM INSTR new #177 <Class File>;
        context.File(l, "/apk/");
        s = context;
        context = JVM INSTR new #177 <Class File>;
        context.File(l, "/res/");
        q = context;
_L5:
        int i1 = packagemanager.checkPermission("android.permission.WRITE_EXTERNAL_STORAGE", y.packageName);
        Context context1;
        Exception exception;
        Object obj;
        Object obj1;
        File file1;
        if (i1 == 0)
            i1 = 1;
        else
            i1 = 0;
        if (!i1)
            break MISSING_BLOCK_LABEL_298;
        if ("mounted".equals(Environment.getExternalStorageState()) && (s.exists() || s.mkdirs()) && (q.exists() || q.mkdirs()))
            break MISSING_BLOCK_LABEL_386;
        s = r.getExternalFilesDir("apk");
        q = r.getExternalFilesDir("res");
        if (s == null || !s.exists() || q == null || !q.exists()) {
            s = r.getDir("apk", 2);
            q = r.getDir("res", 0);
        }
_L7:
        ag.a("apkSaveDir: %s, resSaveDir: %s", new Object[] {
            s.getAbsolutePath(), q.getAbsolutePath()
        });
        context1 = r;
        context = JVM INSTR new #166 <Class StringBuilder>;
        context.StringBuilder();
        z = context1.getSharedPreferences(context.append(r.getPackageName()).append(".BETA_VALUES").toString(), 0);
        B = z.getBoolean("isFirstRun", true);
        if (B)
            z.edit().putBoolean("isFirstRun", false).apply();
        E = (BetaUploadStrategy)com.tencent.bugly.proguard.a.a("us.bch", BetaUploadStrategy.CREATOR);
        if (E == null) {
            context = JVM INSTR new #279 <Class BetaUploadStrategy>;
            context.BetaUploadStrategy();
            E = context;
        }
        this;
        JVM INSTR monitorexit ;
        return;
        exception;
        if (ag.b(exception)) goto _L4; else goto _L3
_L3:
        exception.printStackTrace();
          goto _L4
        context;
        throw context;
_L2:
        obj1 = JVM INSTR new #177 <Class File>;
        file1 = l;
        obj = JVM INSTR new #166 <Class StringBuilder>;
        ((StringBuilder) (obj)).StringBuilder();
        ((File) (obj1)).File(file1, ((StringBuilder) (obj)).append(context.toString()).append("/apk/").toString());
        s = ((File) (obj1));
        obj = JVM INSTR new #177 <Class File>;
        file1 = l;
        obj1 = JVM INSTR new #166 <Class StringBuilder>;
        ((StringBuilder) (obj1)).StringBuilder();
        ((File) (obj)).File(file1, ((StringBuilder) (obj1)).append(context.toString()).append("/res/").toString());
        q = ((File) (obj));
          goto _L5
        context;
        if (ag.b(context)) goto _L7; else goto _L6
_L6:
        context.printStackTrace();
          goto _L7
    }

}
