// Decompiled by Jad v1.5.8g. Copyright 2001 Pavel Kouznetsov.
// Jad home page: http://www.kpdus.com/jad.html
// Decompiler options: packimports(3) fieldsfirst nonlb space 

package net.lightbody.bmp.mitm;

import java.security.cert.X509Certificate;
import java.util.Date;
import java.util.List;

// Referenced classes of package net.lightbody.bmp.mitm:
//            CertificateInfoGenerator, CertificateInfo

public class HostnameCertificateInfoGenerator
    implements CertificateInfoGenerator {

    private static final String DEFAULT_IMPERSONATED_CERT_ORG = "Impersonated Certificate";
    private static final String DEFAULT_IMPERSONATED_CERT_ORG_UNIT = "LittleProxy MITM";

    public HostnameCertificateInfoGenerator() {
    }

    public CertificateInfo generate(List list, X509Certificate x509certificate) {
        if (list == null || list.size() < 1) {
            throw new IllegalArgumentException("Cannot create X.509 certificate without server hostname");
        } else {
            x509certificate = (String)list.get(0);
            return (new CertificateInfo()).commonName(x509certificate).organization("Impersonated Certificate").organizationalUnit("LittleProxy MITM").notBefore(getNotBefore()).notAfter(getNotAfter()).subjectAlternativeNames(list);
        }
    }

    protected Date getNotAfter() {
        return new Date(System.currentTimeMillis() + 0x57b12c00L);
    }

    protected Date getNotBefore() {
        return new Date(System.currentTimeMillis() - 0x57b12c00L);
    }
}
