// Decompiled by Jad v1.5.8g. Copyright 2001 Pavel Kouznetsov.
// Jad home page: http://www.kpdus.com/jad.html
// Decompiler options: packimports(3) fieldsfirst nonlb space 

package android.support.v4.view;

import android.content.Context;
import android.content.res.*;
import android.database.DataSetObserver;
import android.graphics.drawable.Drawable;
import android.util.AttributeSet;
import android.util.DisplayMetrics;
import android.view.ViewGroup;
import android.widget.TextView;
import java.lang.ref.WeakReference;

// Referenced classes of package android.support.v4.view:
//            ViewPager, PagerAdapter, ViewCompat, PagerTitleStripIcs

public class PagerTitleStrip extends ViewGroup {
    private class PageListener extends DataSetObserver
        implements ViewPager.OnAdapterChangeListener, ViewPager.OnPageChangeListener {

        private int mScrollState;
        final PagerTitleStrip this$0;

        public void onAdapterChanged(ViewPager viewpager, PagerAdapter pageradapter, PagerAdapter pageradapter1) {
            updateAdapter(pageradapter, pageradapter1);
        }

        public void onChanged() {
            float f = 0.0F;
            updateText(mPager.getCurrentItem(), mPager.getAdapter());
            if (mLastKnownPositionOffset >= 0.0F)
                f = mLastKnownPositionOffset;
            updateTextPositions(mPager.getCurrentItem(), f, true);
        }

        public void onPageScrollStateChanged(int i) {
            mScrollState = i;
        }

        public void onPageScrolled(int i, float f, int j) {
            j = i;
            if (f > 0.5F)
                j = i + 1;
            updateTextPositions(j, f, false);
        }

        public void onPageSelected(int i) {
            float f = 0.0F;
            if (mScrollState == 0) {
                updateText(mPager.getCurrentItem(), mPager.getAdapter());
                if (mLastKnownPositionOffset >= 0.0F)
                    f = mLastKnownPositionOffset;
                updateTextPositions(mPager.getCurrentItem(), f, true);
            }
        }

        PageListener() {
            this$0 = PagerTitleStrip.this;
            super();
        }
    }

    static interface PagerTitleStripImpl {

        public abstract void setSingleLineAllCaps(TextView textview);
    }

    static class PagerTitleStripImplBase
        implements PagerTitleStripImpl {

        public void setSingleLineAllCaps(TextView textview) {
            textview.setSingleLine();
        }

        PagerTitleStripImplBase() {
        }
    }

    static class PagerTitleStripImplIcs
        implements PagerTitleStripImpl {

        public void setSingleLineAllCaps(TextView textview) {
            PagerTitleStripIcs.setSingleLineAllCaps(textview);
        }

        PagerTitleStripImplIcs() {
        }
    }


    private static final int ATTRS[] = {
        0x1010034, 0x1010095, 0x1010098, 0x10100af
    };
    private static final PagerTitleStripImpl IMPL;
    private static final float SIDE_ALPHA = 0.6F;
    private static final String TAG = "PagerTitleStrip";
    private static final int TEXT_ATTRS[] = {
        0x101038c
    };
    private static final int TEXT_SPACING = 16;
    TextView mCurrText;
    private int mGravity;
    private int mLastKnownCurrentPage;
    float mLastKnownPositionOffset;
    TextView mNextText;
    private int mNonPrimaryAlpha;
    private final PageListener mPageListener;
    ViewPager mPager;
    TextView mPrevText;
    private int mScaledTextSpacing;
    int mTextColor;
    private boolean mUpdatingPositions;
    private boolean mUpdatingText;
    private WeakReference mWatchingAdapter;

    public PagerTitleStrip(Context context) {
        this(context, null);
    }

    public PagerTitleStrip(Context context, AttributeSet attributeset) {
        boolean flag = false;
        super(context, attributeset);
        mLastKnownCurrentPage = -1;
        mLastKnownPositionOffset = -1F;
        mPageListener = new PageListener();
        TextView textview = new TextView(context);
        mPrevText = textview;
        addView(textview);
        textview = new TextView(context);
        mCurrText = textview;
        addView(textview);
        textview = new TextView(context);
        mNextText = textview;
        addView(textview);
        attributeset = context.obtainStyledAttributes(attributeset, ATTRS);
        int i = attributeset.getResourceId(0, 0);
        if (i != 0) {
            mPrevText.setTextAppearance(context, i);
            mCurrText.setTextAppearance(context, i);
            mNextText.setTextAppearance(context, i);
        }
        int j = attributeset.getDimensionPixelSize(1, 0);
        if (j != 0)
            setTextSize(0, j);
        if (attributeset.hasValue(2)) {
            int k = attributeset.getColor(2, 0);
            mPrevText.setTextColor(k);
            mCurrText.setTextColor(k);
            mNextText.setTextColor(k);
        }
        mGravity = attributeset.getInteger(3, 80);
        attributeset.recycle();
        mTextColor = mCurrText.getTextColors().getDefaultColor();
        setNonPrimaryAlpha(0.6F);
        mPrevText.setEllipsize(android.text.TextUtils.TruncateAt.END);
        mCurrText.setEllipsize(android.text.TextUtils.TruncateAt.END);
        mNextText.setEllipsize(android.text.TextUtils.TruncateAt.END);
        if (i != 0) {
            attributeset = context.obtainStyledAttributes(i, TEXT_ATTRS);
            flag = attributeset.getBoolean(0, false);
            attributeset.recycle();
        }
        if (flag) {
            setSingleLineAllCaps(mPrevText);
            setSingleLineAllCaps(mCurrText);
            setSingleLineAllCaps(mNextText);
        } else {
            mPrevText.setSingleLine();
            mCurrText.setSingleLine();
            mNextText.setSingleLine();
        }
        mScaledTextSpacing = (int)(context.getResources().getDisplayMetrics().density * 16F);
    }

    private static void setSingleLineAllCaps(TextView textview) {
        IMPL.setSingleLineAllCaps(textview);
    }

    int getMinHeight() {
        int i = 0;
        Drawable drawable = getBackground();
        if (drawable != null)
            i = drawable.getIntrinsicHeight();
        return i;
    }

    public int getTextSpacing() {
        return mScaledTextSpacing;
    }

    protected void onAttachedToWindow() {
        super.onAttachedToWindow();
        Object obj = getParent();
        if (!(obj instanceof ViewPager))
            throw new IllegalStateException("PagerTitleStrip must be a direct child of a ViewPager.");
        obj = (ViewPager)obj;
        PagerAdapter pageradapter = ((ViewPager) (obj)).getAdapter();
        ((ViewPager) (obj)).setInternalPageChangeListener(mPageListener);
        ((ViewPager) (obj)).addOnAdapterChangeListener(mPageListener);
        mPager = ((ViewPager) (obj));
        if (mWatchingAdapter != null)
            obj = (PagerAdapter)mWatchingAdapter.get();
        else
            obj = null;
        updateAdapter(((PagerAdapter) (obj)), pageradapter);
    }

    protected void onDetachedFromWindow() {
        super.onDetachedFromWindow();
        if (mPager != null) {
            updateAdapter(mPager.getAdapter(), null);
            mPager.setInternalPageChangeListener(null);
            mPager.removeOnAdapterChangeListener(mPageListener);
            mPager = null;
        }
    }

    protected void onLayout(boolean flag, int i, int j, int k, int l) {
        float f = 0.0F;
        if (mPager != null) {
            if (mLastKnownPositionOffset >= 0.0F)
                f = mLastKnownPositionOffset;
            updateTextPositions(mLastKnownCurrentPage, f, true);
        }
    }

    protected void onMeasure(int i, int j) {
        if (android.view.View.MeasureSpec.getMode(i) != 0x40000000)
            throw new IllegalStateException("Must measure with an exact width");
        int l = getPaddingTop() + getPaddingBottom();
        int i1 = getChildMeasureSpec(j, l, -2);
        int k = android.view.View.MeasureSpec.getSize(i);
        i = getChildMeasureSpec(i, (int)((float)k * 0.2F), -2);
        mPrevText.measure(i, i1);
        mCurrText.measure(i, i1);
        mNextText.measure(i, i1);
        if (android.view.View.MeasureSpec.getMode(j) == 0x40000000) {
            i = android.view.View.MeasureSpec.getSize(j);
        } else {
            i = mCurrText.getMeasuredHeight();
            i = Math.max(getMinHeight(), l + i);
        }
        setMeasuredDimension(k, ViewCompat.resolveSizeAndState(i, j, ViewCompat.getMeasuredState(mCurrText) << 16));
    }

    public void requestLayout() {
        if (!mUpdatingText)
            super.requestLayout();
    }

    public void setGravity(int i) {
        mGravity = i;
        requestLayout();
    }

    public void setNonPrimaryAlpha(float f) {
        mNonPrimaryAlpha = (int)(255F * f) & 0xff;
        int i = mNonPrimaryAlpha << 24 | mTextColor & 0xffffff;
        mPrevText.setTextColor(i);
        mNextText.setTextColor(i);
    }

    public void setTextColor(int i) {
        mTextColor = i;
        mCurrText.setTextColor(i);
        i = mNonPrimaryAlpha << 24 | mTextColor & 0xffffff;
        mPrevText.setTextColor(i);
        mNextText.setTextColor(i);
    }

    public void setTextSize(int i, float f) {
        mPrevText.setTextSize(i, f);
        mCurrText.setTextSize(i, f);
        mNextText.setTextSize(i, f);
    }

    public void setTextSpacing(int i) {
        mScaledTextSpacing = i;
        requestLayout();
    }

    void updateAdapter(PagerAdapter pageradapter, PagerAdapter pageradapter1) {
        if (pageradapter != null) {
            pageradapter.unregisterDataSetObserver(mPageListener);
            mWatchingAdapter = null;
        }
        if (pageradapter1 != null) {
            pageradapter1.registerDataSetObserver(mPageListener);
            mWatchingAdapter = new WeakReference(pageradapter1);
        }
        if (mPager != null) {
            mLastKnownCurrentPage = -1;
            mLastKnownPositionOffset = -1F;
            updateText(mPager.getCurrentItem(), pageradapter1);
            requestLayout();
        }
    }

    void updateText(int i, PagerAdapter pageradapter) {
        Object obj = null;
        int j;
        int k;
        CharSequence charsequence;
        TextView textview;
        if (pageradapter != null)
            j = pageradapter.getCount();
        else
            j = 0;
        mUpdatingText = true;
        if (i >= 1 && pageradapter != null)
            charsequence = pageradapter.getPageTitle(i - 1);
        else
            charsequence = null;
        mPrevText.setText(charsequence);
        textview = mCurrText;
        if (pageradapter != null && i < j)
            charsequence = pageradapter.getPageTitle(i);
        else
            charsequence = null;
        textview.setText(charsequence);
        charsequence = obj;
        if (i + 1 < j) {
            charsequence = obj;
            if (pageradapter != null)
                charsequence = pageradapter.getPageTitle(i + 1);
        }
        mNextText.setText(charsequence);
        j = android.view.View.MeasureSpec.makeMeasureSpec(Math.max(0, (int)((float)(getWidth() - getPaddingLeft() - getPaddingRight()) * 0.8F)), 0x80000000);
        k = android.view.View.MeasureSpec.makeMeasureSpec(Math.max(0, getHeight() - getPaddingTop() - getPaddingBottom()), 0x80000000);
        mPrevText.measure(j, k);
        mCurrText.measure(j, k);
        mNextText.measure(j, k);
        mLastKnownCurrentPage = i;
        if (!mUpdatingPositions)
            updateTextPositions(i, mLastKnownPositionOffset, false);
        mUpdatingText = false;
    }

    void updateTextPositions(int i, float f, boolean flag) {
        if (i == mLastKnownCurrentPage) goto _L2; else goto _L1
_L1:
        updateText(i, mPager.getAdapter());
_L7:
        int j;
        int k;
        int l;
        int i1;
        int j1;
        int k1;
        int l1;
        int i2;
        int j2;
        int k2;
        int l2;
        int i3;
        int j3;
        mUpdatingPositions = true;
        i1 = mPrevText.getMeasuredWidth();
        k = mCurrText.getMeasuredWidth();
        l = mNextText.getMeasuredWidth();
        i2 = k / 2;
        k1 = getWidth();
        l2 = getHeight();
        l1 = getPaddingLeft();
        j1 = getPaddingRight();
        i = getPaddingTop();
        j = getPaddingBottom();
        j2 = j1 + i2;
        float f2 = 0.5F + f;
        float f1 = f2;
        if (f2 > 1.0F)
            f1 = f2 - 1.0F;
        j2 = k1 - j2 - (int)(f1 * (float)(k1 - (l1 + i2) - j2)) - k / 2;
        i2 = j2 + k;
        i3 = mPrevText.getBaseline();
        k = mCurrText.getBaseline();
        j3 = mNextText.getBaseline();
        k2 = Math.max(Math.max(i3, k), j3);
        i3 = k2 - i3;
        k = k2 - k;
        k2 -= j3;
        j3 = mPrevText.getMeasuredHeight();
        int l3 = mCurrText.getMeasuredHeight();
        int k3 = mNextText.getMeasuredHeight();
        j3 = Math.max(Math.max(j3 + i3, l3 + k), k3 + k2);
        mGravity & 0x70;
        JVM INSTR lookupswitch 2: default 304
    //                   16: 458
    //                   80: 491;
           goto _L3 _L4 _L5
_L5:
        break MISSING_BLOCK_LABEL_491;
_L3:
        j = i + i3;
        k += i;
        i += k2;
_L8:
        mCurrText.layout(j2, k, i2, mCurrText.getMeasuredHeight() + k);
        k = Math.min(l1, j2 - mScaledTextSpacing - i1);
        mPrevText.layout(k, j, i1 + k, mPrevText.getMeasuredHeight() + j);
        j = Math.max(k1 - j1 - l, mScaledTextSpacing + i2);
        mNextText.layout(j, i, j + l, mNextText.getMeasuredHeight() + i);
        mLastKnownPositionOffset = f;
        mUpdatingPositions = false;
_L6:
        return;
_L2:
        if (flag || f != mLastKnownPositionOffset) goto _L7; else goto _L6
_L4:
        i = (l2 - i - j - j3) / 2;
        j = i + i3;
        k += i;
        i += k2;
          goto _L8
        i = l2 - j - j3;
        j = i + i3;
        k += i;
        i += k2;
          goto _L8
    }

    static  {
        if (android.os.Build.VERSION.SDK_INT >= 14)
            IMPL = new PagerTitleStripImplIcs();
        else
            IMPL = new PagerTitleStripImplBase();
    }
}
