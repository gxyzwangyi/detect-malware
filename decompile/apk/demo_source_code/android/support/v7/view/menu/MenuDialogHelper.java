// Decompiled by Jad v1.5.8g. Copyright 2001 Pavel Kouznetsov.
// Jad home page: http://www.kpdus.com/jad.html
// Decompiler options: packimports(3) fieldsfirst nonlb space 

package android.support.v7.view.menu;

import android.content.DialogInterface;
import android.os.IBinder;
import android.support.v7.app.AlertDialog;
import android.view.*;
import android.widget.ListAdapter;

// Referenced classes of package android.support.v7.view.menu:
//            ListMenuPresenter, MenuItemImpl, MenuBuilder

class MenuDialogHelper
    implements android.content.DialogInterface.OnClickListener, android.content.DialogInterface.OnDismissListener, android.content.DialogInterface.OnKeyListener, MenuPresenter.Callback {

    private AlertDialog mDialog;
    private MenuBuilder mMenu;
    ListMenuPresenter mPresenter;
    private MenuPresenter.Callback mPresenterCallback;

    public MenuDialogHelper(MenuBuilder menubuilder) {
        mMenu = menubuilder;
    }

    public void dismiss() {
        if (mDialog != null)
            mDialog.dismiss();
    }

    public void onClick(DialogInterface dialoginterface, int i) {
        mMenu.performItemAction((MenuItemImpl)mPresenter.getAdapter().getItem(i), 0);
    }

    public void onCloseMenu(MenuBuilder menubuilder, boolean flag) {
        if (flag || menubuilder == mMenu)
            dismiss();
        if (mPresenterCallback != null)
            mPresenterCallback.onCloseMenu(menubuilder, flag);
    }

    public void onDismiss(DialogInterface dialoginterface) {
        mPresenter.onCloseMenu(mMenu, true);
    }

    public boolean onKey(DialogInterface dialoginterface, int i, KeyEvent keyevent) {
        boolean flag = true;
        if (i != 82 && i != 4) goto _L2; else goto _L1
_L1:
        if (keyevent.getAction() != 0 || keyevent.getRepeatCount() != 0) goto _L4; else goto _L3
_L3:
        dialoginterface = mDialog.getWindow();
        if (dialoginterface == null) goto _L2; else goto _L5
_L5:
        dialoginterface = dialoginterface.getDecorView();
        if (dialoginterface == null) goto _L2; else goto _L6
_L6:
        dialoginterface = dialoginterface.getKeyDispatcherState();
        if (dialoginterface == null) goto _L2; else goto _L7
_L7:
        dialoginterface.startTracking(keyevent, this);
_L9:
        return flag;
_L4:
        if (keyevent.getAction() == 1 && !keyevent.isCanceled()) {
            Object obj = mDialog.getWindow();
            if (obj != null) {
                obj = ((Window) (obj)).getDecorView();
                if (obj != null) {
                    obj = ((View) (obj)).getKeyDispatcherState();
                    if (obj != null && ((android.view.KeyEvent.DispatcherState) (obj)).isTracking(keyevent)) {
                        mMenu.close(true);
                        dialoginterface.dismiss();
                        continue; /* Loop/switch isn't completed */
                    }
                }
            }
        }
_L2:
        flag = mMenu.performShortcut(i, keyevent, 0);
        if (true) goto _L9; else goto _L8
_L8:
    }

    public boolean onOpenSubMenu(MenuBuilder menubuilder) {
        boolean flag;
        if (mPresenterCallback != null)
            flag = mPresenterCallback.onOpenSubMenu(menubuilder);
        else
            flag = false;
        return flag;
    }

    public void setPresenterCallback(MenuPresenter.Callback callback) {
        mPresenterCallback = callback;
    }

    public void show(IBinder ibinder) {
        MenuBuilder menubuilder = mMenu;
        Object obj = new android.support.v7.app.AlertDialog.Builder(menubuilder.getContext());
        mPresenter = new ListMenuPresenter(((android.support.v7.app.AlertDialog.Builder) (obj)).getContext(), android.support.v7.appcompat.R.layout.abc_list_menu_item_layout);
        mPresenter.setCallback(this);
        mMenu.addMenuPresenter(mPresenter);
        ((android.support.v7.app.AlertDialog.Builder) (obj)).setAdapter(mPresenter.getAdapter(), this);
        View view = menubuilder.getHeaderView();
        if (view != null)
            ((android.support.v7.app.AlertDialog.Builder) (obj)).setCustomTitle(view);
        else
            ((android.support.v7.app.AlertDialog.Builder) (obj)).setIcon(menubuilder.getHeaderIcon()).setTitle(menubuilder.getHeaderTitle());
        ((android.support.v7.app.AlertDialog.Builder) (obj)).setOnKeyListener(this);
        mDialog = ((android.support.v7.app.AlertDialog.Builder) (obj)).create();
        mDialog.setOnDismissListener(this);
        obj = mDialog.getWindow().getAttributes();
        obj.type = 1003;
        if (ibinder != null)
            obj.token = ibinder;
        obj.flags = ((android.view.WindowManager.LayoutParams) (obj)).flags | 0x20000;
        mDialog.show();
    }
}
