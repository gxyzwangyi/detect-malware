// Decompiled by Jad v1.5.8g. Copyright 2001 Pavel Kouznetsov.
// Jad home page: http://www.kpdus.com/jad.html
// Decompiler options: packimports(3) fieldsfirst nonlb space 

package org.bouncycastle.openssl;

import java.io.IOException;
import java.math.BigInteger;
import java.util.ArrayList;
import java.util.List;
import org.bouncycastle.asn1.bd;
import org.bouncycastle.asn1.j.a;
import org.bouncycastle.asn1.k;
import org.bouncycastle.asn1.k.e;
import org.bouncycastle.asn1.n;
import org.bouncycastle.asn1.o.j;
import org.bouncycastle.asn1.o.y;
import org.bouncycastle.asn1.p.g;
import org.bouncycastle.asn1.r;
import org.bouncycastle.cert.d;
import org.bouncycastle.util.f;
import org.bouncycastle.util.io.pem.PemGenerationException;
import org.bouncycastle.util.io.pem.c;

// Referenced classes of package org.bouncycastle.openssl:
//            f, j

public class b
    implements c {

    private static final n a[];
    private static final byte b[] = {
        48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 
        65, 66, 67, 68, 69, 70
    };
    private final Object c;
    private final org.bouncycastle.openssl.f d;

    public b(Object obj, org.bouncycastle.openssl.f f1) {
        c = obj;
        d = f1;
    }

    private String a(byte abyte0[]) {
        char ac[] = new char[abyte0.length * 2];
        for (int i = 0; i != abyte0.length; i++) {
            int l = abyte0[i] & 0xff;
            ac[i * 2] = (char)b[l >>> 4];
            ac[i * 2 + 1] = (char)b[l & 0xf];
        }

        return new String(ac);
    }

    private org.bouncycastle.util.io.pem.b a(Object obj) {
        if (!(obj instanceof org.bouncycastle.util.io.pem.b)) goto _L2; else goto _L1
_L1:
        obj = (org.bouncycastle.util.io.pem.b)obj;
_L8:
        return ((org.bouncycastle.util.io.pem.b) (obj));
_L2:
        if (!(obj instanceof c)) goto _L4; else goto _L3
_L3:
        obj = ((c)obj).a();
          goto _L5
_L4:
        if (!(obj instanceof d)) goto _L7; else goto _L6
_L6:
        Object obj1;
        obj1 = "CERTIFICATE";
        obj = ((d)obj).a();
_L9:
        if (d != null) {
            String s1 = f.b(d.a());
            String s = s1;
            if (s1.equals("DESEDE"))
                s = "DES-EDE3-CBC";
            byte abyte0[] = d.b();
            byte abyte1[] = d.a(((byte []) (obj)));
            obj = new ArrayList(2);
            ((List) (obj)).add(new org.bouncycastle.util.io.pem.a("Proc-Type", "4,ENCRYPTED"));
            ((List) (obj)).add(new org.bouncycastle.util.io.pem.a("DEK-Info", (new StringBuilder()).append(s).append(",").append(a(abyte0)).toString()));
            obj = new org.bouncycastle.util.io.pem.b(((String) (obj1)), ((List) (obj)), abyte1);
        } else {
            obj = new org.bouncycastle.util.io.pem.b(((String) (obj1)), ((byte []) (obj)));
        }
_L5:
        if (true) goto _L8; else goto _L7
_L7:
        if (obj instanceof org.bouncycastle.cert.c) {
            obj1 = "X509 CRL";
            obj = ((org.bouncycastle.cert.c)obj).a();
        } else
        if (obj instanceof org.bouncycastle.openssl.j) {
            obj1 = "TRUSTED CERTIFICATE";
            obj = ((org.bouncycastle.openssl.j)obj).a();
        } else
        if (obj instanceof org.bouncycastle.asn1.k.f) {
            obj = (org.bouncycastle.asn1.k.f)obj;
            obj1 = ((org.bouncycastle.asn1.k.f) (obj)).a().a();
            if (((n) (obj1)).equals(e.b)) {
                obj1 = "RSA PRIVATE KEY";
                obj = ((org.bouncycastle.asn1.k.f) (obj)).b().h().i();
            } else
            if (((n) (obj1)).equals(a[0]) || ((n) (obj1)).equals(a[1])) {
                obj1 = "DSA PRIVATE KEY";
                j j1 = j.a(((org.bouncycastle.asn1.k.f) (obj)).a().b());
                org.bouncycastle.asn1.g g1 = new org.bouncycastle.asn1.g();
                g1.a(new k(0L));
                g1.a(new k(j1.a()));
                g1.a(new k(j1.b()));
                g1.a(new k(j1.c()));
                obj = k.a(((org.bouncycastle.asn1.k.f) (obj)).b()).c();
                g1.a(new k(j1.c().modPow(((BigInteger) (obj)), j1.a())));
                g1.a(new k(((BigInteger) (obj))));
                obj = (new bd(g1)).i();
            } else
            if (((n) (obj1)).equals(g.k)) {
                obj1 = "EC PRIVATE KEY";
                obj = ((org.bouncycastle.asn1.k.f) (obj)).b().h().i();
            } else {
                throw new IOException("Cannot identify private key");
            }
        } else
        if (obj instanceof y) {
            obj1 = "PUBLIC KEY";
            obj = ((y)obj).i();
        } else
        if (obj instanceof org.bouncycastle.cert.b) {
            obj1 = "ATTRIBUTE CERTIFICATE";
            obj = ((org.bouncycastle.cert.b)obj).a();
        } else
        if (obj instanceof org.bouncycastle.pkcs.a) {
            obj1 = "CERTIFICATE REQUEST";
            obj = ((org.bouncycastle.pkcs.a)obj).b();
        } else
        if (obj instanceof org.bouncycastle.asn1.b.a) {
            obj1 = "PKCS7";
            obj = ((org.bouncycastle.asn1.b.a)obj).i();
        } else {
            throw new PemGenerationException("unknown object passed - can't encode.");
        }
          goto _L9
    }

    public org.bouncycastle.util.io.pem.b a() {
        org.bouncycastle.util.io.pem.b b1;
        try {
            b1 = a(c);
        }
        catch (IOException ioexception) {
            throw new PemGenerationException((new StringBuilder()).append("encoding exception: ").append(ioexception.getMessage()).toString(), ioexception);
        }
        return b1;
    }

    static  {
        a = (new n[] {
            g.U, a.j
        });
    }
}
