.class public Lnet/lightbody/bmp/mitm/manager/ImpersonatingMitmManager$Builder;
.super Ljava/lang/Object;


# annotations
.annotation system Ldalvik/annotation/EnclosingClass;
    value = Lnet/lightbody/bmp/mitm/manager/ImpersonatingMitmManager;
.end annotation

.annotation system Ldalvik/annotation/InnerClass;
    accessFlags = 0x9
    name = "Builder"
.end annotation


# instance fields
.field private cacheConcurrencyLevel:I

.field private cacheExpirationIntervalMs:J

.field private certificateInfoGenerator:Lnet/lightbody/bmp/mitm/CertificateInfoGenerator;

.field private clientCiphers:Ljava/util/Collection;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/Collection",
            "<",
            "Ljava/lang/String;",
            ">;"
        }
    .end annotation
.end field

.field private rootCertificateSource:Lnet/lightbody/bmp/mitm/CertificateAndKeySource;

.field private securityProviderTool:Lnet/lightbody/bmp/mitm/tools/SecurityProviderTool;

.field private serverCiphers:Ljava/util/Collection;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/Collection",
            "<",
            "Ljava/lang/String;",
            ">;"
        }
    .end annotation
.end field

.field private serverKeyGenerator:Lnet/lightbody/bmp/mitm/keys/KeyGenerator;

.field private serverMessageDigest:Ljava/lang/String;

.field private trustSource:Lnet/lightbody/bmp/mitm/TrustSource;


# direct methods
.method public constructor <init>()V
    .locals 4

    invoke-direct {p0}, Ljava/lang/Object;-><init>()V

    invoke-static {}, Lnet/lightbody/bmp/mitm/RootCertificateGenerator;->builder()Lnet/lightbody/bmp/mitm/RootCertificateGenerator$Builder;

    move-result-object v0

    invoke-virtual {v0}, Lnet/lightbody/bmp/mitm/RootCertificateGenerator$Builder;->build()Lnet/lightbody/bmp/mitm/RootCertificateGenerator;

    move-result-object v0

    iput-object v0, p0, Lnet/lightbody/bmp/mitm/manager/ImpersonatingMitmManager$Builder;->rootCertificateSource:Lnet/lightbody/bmp/mitm/CertificateAndKeySource;

    new-instance v0, Lnet/lightbody/bmp/mitm/keys/RSAKeyGenerator;

    invoke-direct {v0}, Lnet/lightbody/bmp/mitm/keys/RSAKeyGenerator;-><init>()V

    iput-object v0, p0, Lnet/lightbody/bmp/mitm/manager/ImpersonatingMitmManager$Builder;->serverKeyGenerator:Lnet/lightbody/bmp/mitm/keys/KeyGenerator;

    invoke-static {}, Lnet/lightbody/bmp/mitm/TrustSource;->defaultTrustSource()Lnet/lightbody/bmp/mitm/TrustSource;

    move-result-object v0

    iput-object v0, p0, Lnet/lightbody/bmp/mitm/manager/ImpersonatingMitmManager$Builder;->trustSource:Lnet/lightbody/bmp/mitm/TrustSource;

    const/16 v0, 0x8

    iput v0, p0, Lnet/lightbody/bmp/mitm/manager/ImpersonatingMitmManager$Builder;->cacheConcurrencyLevel:I

    sget-object v0, Ljava/util/concurrent/TimeUnit;->MILLISECONDS:Ljava/util/concurrent/TimeUnit;

    const-wide/16 v2, 0x5

    sget-object v1, Ljava/util/concurrent/TimeUnit;->MINUTES:Ljava/util/concurrent/TimeUnit;

    invoke-virtual {v0, v2, v3, v1}, Ljava/util/concurrent/TimeUnit;->convert(JLjava/util/concurrent/TimeUnit;)J

    move-result-wide v0

    iput-wide v0, p0, Lnet/lightbody/bmp/mitm/manager/ImpersonatingMitmManager$Builder;->cacheExpirationIntervalMs:J

    sget-object v0, Lnet/lightbody/bmp/mitm/util/MitmConstants;->DEFAULT_MESSAGE_DIGEST:Ljava/lang/String;

    iput-object v0, p0, Lnet/lightbody/bmp/mitm/manager/ImpersonatingMitmManager$Builder;->serverMessageDigest:Ljava/lang/String;

    new-instance v0, Lnet/lightbody/bmp/mitm/tools/DefaultSecurityProviderTool;

    invoke-direct {v0}, Lnet/lightbody/bmp/mitm/tools/DefaultSecurityProviderTool;-><init>()V

    iput-object v0, p0, Lnet/lightbody/bmp/mitm/manager/ImpersonatingMitmManager$Builder;->securityProviderTool:Lnet/lightbody/bmp/mitm/tools/SecurityProviderTool;

    new-instance v0, Lnet/lightbody/bmp/mitm/HostnameCertificateInfoGenerator;

    invoke-direct {v0}, Lnet/lightbody/bmp/mitm/HostnameCertificateInfoGenerator;-><init>()V

    iput-object v0, p0, Lnet/lightbody/bmp/mitm/manager/ImpersonatingMitmManager$Builder;->certificateInfoGenerator:Lnet/lightbody/bmp/mitm/CertificateInfoGenerator;

    return-void
.end method


# virtual methods
.method public build()Lnet/lightbody/bmp/mitm/manager/ImpersonatingMitmManager;
    .locals 12

    iget-object v0, p0, Lnet/lightbody/bmp/mitm/manager/ImpersonatingMitmManager$Builder;->clientCiphers:Ljava/util/Collection;

    if-nez v0, :cond_0

    invoke-static {}, Lnet/lightbody/bmp/mitm/util/SslUtil;->getDefaultCipherList()Ljava/util/List;

    move-result-object v0

    iput-object v0, p0, Lnet/lightbody/bmp/mitm/manager/ImpersonatingMitmManager$Builder;->clientCiphers:Ljava/util/Collection;

    :cond_0
    iget-object v0, p0, Lnet/lightbody/bmp/mitm/manager/ImpersonatingMitmManager$Builder;->serverCiphers:Ljava/util/Collection;

    if-nez v0, :cond_1

    invoke-static {}, Lnet/lightbody/bmp/mitm/util/SslUtil;->getDefaultCipherList()Ljava/util/List;

    move-result-object v0

    iput-object v0, p0, Lnet/lightbody/bmp/mitm/manager/ImpersonatingMitmManager$Builder;->serverCiphers:Ljava/util/Collection;

    :cond_1
    new-instance v0, Lnet/lightbody/bmp/mitm/manager/ImpersonatingMitmManager;

    iget-object v1, p0, Lnet/lightbody/bmp/mitm/manager/ImpersonatingMitmManager$Builder;->rootCertificateSource:Lnet/lightbody/bmp/mitm/CertificateAndKeySource;

    iget-object v2, p0, Lnet/lightbody/bmp/mitm/manager/ImpersonatingMitmManager$Builder;->serverKeyGenerator:Lnet/lightbody/bmp/mitm/keys/KeyGenerator;

    iget-object v3, p0, Lnet/lightbody/bmp/mitm/manager/ImpersonatingMitmManager$Builder;->serverMessageDigest:Ljava/lang/String;

    iget-object v4, p0, Lnet/lightbody/bmp/mitm/manager/ImpersonatingMitmManager$Builder;->trustSource:Lnet/lightbody/bmp/mitm/TrustSource;

    iget v5, p0, Lnet/lightbody/bmp/mitm/manager/ImpersonatingMitmManager$Builder;->cacheConcurrencyLevel:I

    iget-wide v6, p0, Lnet/lightbody/bmp/mitm/manager/ImpersonatingMitmManager$Builder;->cacheExpirationIntervalMs:J

    iget-object v8, p0, Lnet/lightbody/bmp/mitm/manager/ImpersonatingMitmManager$Builder;->securityProviderTool:Lnet/lightbody/bmp/mitm/tools/SecurityProviderTool;

    iget-object v9, p0, Lnet/lightbody/bmp/mitm/manager/ImpersonatingMitmManager$Builder;->certificateInfoGenerator:Lnet/lightbody/bmp/mitm/CertificateInfoGenerator;

    iget-object v10, p0, Lnet/lightbody/bmp/mitm/manager/ImpersonatingMitmManager$Builder;->serverCiphers:Ljava/util/Collection;

    iget-object v11, p0, Lnet/lightbody/bmp/mitm/manager/ImpersonatingMitmManager$Builder;->clientCiphers:Ljava/util/Collection;

    invoke-direct/range {v0 .. v11}, Lnet/lightbody/bmp/mitm/manager/ImpersonatingMitmManager;-><init>(Lnet/lightbody/bmp/mitm/CertificateAndKeySource;Lnet/lightbody/bmp/mitm/keys/KeyGenerator;Ljava/lang/String;Lnet/lightbody/bmp/mitm/TrustSource;IJLnet/lightbody/bmp/mitm/tools/SecurityProviderTool;Lnet/lightbody/bmp/mitm/CertificateInfoGenerator;Ljava/util/Collection;Ljava/util/Collection;)V

    return-object v0
.end method

.method public cacheConcurrencyLevel(I)Lnet/lightbody/bmp/mitm/manager/ImpersonatingMitmManager$Builder;
    .locals 0

    iput p1, p0, Lnet/lightbody/bmp/mitm/manager/ImpersonatingMitmManager$Builder;->cacheConcurrencyLevel:I

    return-object p0
.end method

.method public cacheExpirationInterval(JLjava/util/concurrent/TimeUnit;)Lnet/lightbody/bmp/mitm/manager/ImpersonatingMitmManager$Builder;
    .locals 3

    sget-object v0, Ljava/util/concurrent/TimeUnit;->MILLISECONDS:Ljava/util/concurrent/TimeUnit;

    invoke-virtual {v0, p1, p2, p3}, Ljava/util/concurrent/TimeUnit;->convert(JLjava/util/concurrent/TimeUnit;)J

    move-result-wide v0

    iput-wide v0, p0, Lnet/lightbody/bmp/mitm/manager/ImpersonatingMitmManager$Builder;->cacheExpirationIntervalMs:J

    return-object p0
.end method

.method public certificateInfoGenerator(Lnet/lightbody/bmp/mitm/CertificateInfoGenerator;)Lnet/lightbody/bmp/mitm/manager/ImpersonatingMitmManager$Builder;
    .locals 0

    iput-object p1, p0, Lnet/lightbody/bmp/mitm/manager/ImpersonatingMitmManager$Builder;->certificateInfoGenerator:Lnet/lightbody/bmp/mitm/CertificateInfoGenerator;

    return-object p0
.end method

.method public certificateTool(Lnet/lightbody/bmp/mitm/tools/SecurityProviderTool;)Lnet/lightbody/bmp/mitm/manager/ImpersonatingMitmManager$Builder;
    .locals 0

    iput-object p1, p0, Lnet/lightbody/bmp/mitm/manager/ImpersonatingMitmManager$Builder;->securityProviderTool:Lnet/lightbody/bmp/mitm/tools/SecurityProviderTool;

    return-object p0
.end method

.method public clientCiphers(Ljava/util/Collection;)Lnet/lightbody/bmp/mitm/manager/ImpersonatingMitmManager$Builder;
    .locals 0
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/util/Collection",
            "<",
            "Ljava/lang/String;",
            ">;)",
            "Lnet/lightbody/bmp/mitm/manager/ImpersonatingMitmManager$Builder;"
        }
    .end annotation

    iput-object p1, p0, Lnet/lightbody/bmp/mitm/manager/ImpersonatingMitmManager$Builder;->clientCiphers:Ljava/util/Collection;

    return-object p0
.end method

.method public rootCertificateSource(Lnet/lightbody/bmp/mitm/CertificateAndKeySource;)Lnet/lightbody/bmp/mitm/manager/ImpersonatingMitmManager$Builder;
    .locals 0

    iput-object p1, p0, Lnet/lightbody/bmp/mitm/manager/ImpersonatingMitmManager$Builder;->rootCertificateSource:Lnet/lightbody/bmp/mitm/CertificateAndKeySource;

    return-object p0
.end method

.method public serverCiphers(Ljava/util/Collection;)Lnet/lightbody/bmp/mitm/manager/ImpersonatingMitmManager$Builder;
    .locals 0
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/util/Collection",
            "<",
            "Ljava/lang/String;",
            ">;)",
            "Lnet/lightbody/bmp/mitm/manager/ImpersonatingMitmManager$Builder;"
        }
    .end annotation

    iput-object p1, p0, Lnet/lightbody/bmp/mitm/manager/ImpersonatingMitmManager$Builder;->serverCiphers:Ljava/util/Collection;

    return-object p0
.end method

.method public serverKeyGenerator(Lnet/lightbody/bmp/mitm/keys/KeyGenerator;)Lnet/lightbody/bmp/mitm/manager/ImpersonatingMitmManager$Builder;
    .locals 0

    iput-object p1, p0, Lnet/lightbody/bmp/mitm/manager/ImpersonatingMitmManager$Builder;->serverKeyGenerator:Lnet/lightbody/bmp/mitm/keys/KeyGenerator;

    return-object p0
.end method

.method public serverMessageDigest(Ljava/lang/String;)Lnet/lightbody/bmp/mitm/manager/ImpersonatingMitmManager$Builder;
    .locals 0

    iput-object p1, p0, Lnet/lightbody/bmp/mitm/manager/ImpersonatingMitmManager$Builder;->serverMessageDigest:Ljava/lang/String;

    return-object p0
.end method

.method public trustAllServers(Z)Lnet/lightbody/bmp/mitm/manager/ImpersonatingMitmManager$Builder;
    .locals 1

    if-eqz p1, :cond_1

    const/4 v0, 0x0

    iput-object v0, p0, Lnet/lightbody/bmp/mitm/manager/ImpersonatingMitmManager$Builder;->trustSource:Lnet/lightbody/bmp/mitm/TrustSource;

    :cond_0
    :goto_0
    return-object p0

    :cond_1
    iget-object v0, p0, Lnet/lightbody/bmp/mitm/manager/ImpersonatingMitmManager$Builder;->trustSource:Lnet/lightbody/bmp/mitm/TrustSource;

    if-nez v0, :cond_0

    invoke-static {}, Lnet/lightbody/bmp/mitm/TrustSource;->defaultTrustSource()Lnet/lightbody/bmp/mitm/TrustSource;

    move-result-object v0

    iput-object v0, p0, Lnet/lightbody/bmp/mitm/manager/ImpersonatingMitmManager$Builder;->trustSource:Lnet/lightbody/bmp/mitm/TrustSource;

    goto :goto_0
.end method

.method public trustSource(Lnet/lightbody/bmp/mitm/TrustSource;)Lnet/lightbody/bmp/mitm/manager/ImpersonatingMitmManager$Builder;
    .locals 0

    iput-object p1, p0, Lnet/lightbody/bmp/mitm/manager/ImpersonatingMitmManager$Builder;->trustSource:Lnet/lightbody/bmp/mitm/TrustSource;

    return-object p0
.end method
